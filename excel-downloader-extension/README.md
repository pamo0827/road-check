# 道路橋DB Excel一括ダウンローダー

## 概要

このChrome拡張機能は、[国土交通省 道路橋データベース](https://road-structures-db-bridge.mlit.go.jp/)の検索結果ページに表示されるすべての点検表（Excelファイル）を、一括でダウンロードするためのツールです。

手動で一つずつダウンロードする手間を省き、作業効率を大幅に向上させます。

## 主な機能

-   **全ページ自動巡回**: 「次へ」ボタンを自動でクリックし、最終ページまで移動します。
-   **一括ダウンロード**: 各ページに表示されているすべての点検表ダウンロードリンクを自動でクリックし、ファイルをダウンロードします。

## インストール方法

### 開発者モードで読み込む

1.  このリポジトリをクローン、またはZIPファイルをダウンロードして解凍します。
2.  Google Chromeを開き、アドレスバーに `chrome://extensions` と入力して拡張機能管理ページに移動します。
3.  ページの右上にある「デベロッパー モード」のトグルをオンにします。
4.  「パッケージ化されていない拡張機能を読み込む」ボタンをクリックします。
5.  ファイル選択ダイアログで、ダウンロード・解凍した `excel-downloader-extension` フォルダを選択します。
6.  拡張機能がリストに追加されれば、インストールは完了です。

## 使い方

1.  [国土交通省 道路橋データベース](https://road-structures-db-bridge.mlit.go.jp/)にアクセスし、任意の条件で橋梁を検索します。
2.  検索結果一覧ページが表示されたら、Chromeのツールバーにある本拡張機能のアイコンをクリックします。
3.  表示されたポップアップ内の「全ページの点検表を一括DL」ボタンをクリックします。
4.  確認ダイアログが表示されるので「OK」をクリックすると、ダウンロードが自動的に開始されます。
5.  処理が完了すると、完了を知らせるアラートが表示されます。ダウンロードされたファイルは、ブラウザのデフォルトダウンロードフォルダに保存されます。

## 注意事項

-   ダウンロード処理中は、対象のタブを開いたままにしてください。
-   ネットワークの速度やPCの性能によっては、ダウンロードに時間がかかったり、処理が不安定になったりする場合があります。`content.js`内の待機時間（`DELAY_`で始まる変数）を調整することで、動作が安定する可能性があります。
-   本拡張機能は、対象ウェブサイトのHTML構造の変更によって動作しなくなる可能性があります。

## ファイル構成

-   `manifest.json`: 拡張機能の基本情報や権限を定義します。
-   `popup.html`: 拡張機能アイコンクリック時に表示されるポップアップのHTMLです。
-   `popup.js`: ポップアップのボタンクリックイベントを処理します。
-   `content.js`: 対象のウェブページに挿入され、DOMを操作してダウンロード処理を実行するメインスクリプトです。
-   `background.js`: 将来的な機能拡張のためのバックグラウンドスクリプトです（現在は未使用）。
-   `images/`: 拡張機能のアイコン画像が格納されています。
